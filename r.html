<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Nutrition Calculator with Eggs by Count</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        max-width: 800px;
        margin: auto;
        background: #f9f9f9;
      }
      h1,
      h2 {
        text-align: center;
      }
      select,
      input,
      button {
        padding: 8px;
        margin: 5px 0;
        width: 100%;
        box-sizing: border-box;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }
      th,
      td {
        border: 1px solid #ccc;
        padding: 8px;
      }
      th {
        background: #ddd;
      }
      .total {
        background: #e0ffe0;
        font-weight: bold;
      }
      .meal-block {
        margin-bottom: 40px;
        padding: 10px;
        background: #ffffff;
        border-radius: 6px;
        box-shadow: 0 0 5px #ccc;
      }
    </style>
  </head>
  <body>
    <h1>Nutrition Calculator (Eggs by Count)</h1>

    <label for="mealSelect">Select Meal:</label>
    <select id="mealSelect">
      <option value="breakfast">Breakfast</option>
      <option value="lunch">Lunch</option>
      <option value="dinner">Dinner</option>
      <option value="snack">Snack</option>
    </select>

    <label for="ingredient">Select Ingredient:</label>
    <select id="ingredient" onchange="updateQuantityLabel()">
      <option value="">-- Select --</option>
    </select>

    <label id="quantityLabel" for="quantity">Quantity (grams):</label>
    <input type="number" id="quantity" placeholder="e.g. 100" />

    <button onclick="addIngredient()">Add to Meal</button>

    <div id="mealsContainer"></div>

    <h2>Total Daily Nutrition</h2>
    <table>
      <thead>
        <tr>
          <th>Total Quantity</th>
          <th>Total Protein (g)</th>
          <th>Total Carbs (g)</th>
          <th>Total Fats (g)</th>
        </tr>
      </thead>
      <tbody>
        <tr class="total">
          <td id="dailyQty">0g</td>
          <td id="dailyProtein">0g</td>
          <td id="dailyCarbs">0g</td>
          <td id="dailyFats">0g</td>
        </tr>
      </tbody>
    </table>

    <script>
      // Predefined ingredients per 100g, except "Egg" which is per 1 egg (~50g)
      const ingredients = {
        'Chicken Breast': { protein: 31, carbs: 0, fats: 3.6, per: 100 },
        'Rice (White)': { protein: 2.7, carbs: 28, fats: 0.3, per: 100 },
        'Soya Chunks': { protein: 52, carbs: 33, fats: 0.5, per: 100 },
        Spinach: { protein: 2.9, carbs: 3.6, fats: 0.4, per: 100 },
        'Chickpeas (Boiled)': {
          protein: 8.9,
          carbs: 27.4,
          fats: 2.6,
          per: 100,
        },
        Egg: { protein: 6.5, carbs: 0.55, fats: 5, per: 1 }, // per egg
      };

      const meals = {
        breakfast: [],
        lunch: [],
        dinner: [],
        snack: [],
      };

      const ingredientSelect = document.getElementById('ingredient');
      const mealsContainer = document.getElementById('mealsContainer');

      // Populate dropdown
      Object.keys(ingredients).forEach((name) => {
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        ingredientSelect.appendChild(option);
      });

      function updateQuantityLabel() {
        const selected = ingredientSelect.value;
        const label = document.getElementById('quantityLabel');
        label.textContent =
          selected === 'Egg'
            ? 'Quantity (number of eggs):'
            : 'Quantity (grams):';
      }

      function addIngredient() {
        const mealName = document.getElementById('mealSelect').value;
        const ingredient = document.getElementById('ingredient').value;
        const inputQty = parseFloat(document.getElementById('quantity').value);

        if (!ingredient || isNaN(inputQty) || inputQty <= 0) {
          alert('Select ingredient and enter a valid quantity.');
          return;
        }

        const data = ingredients[ingredient];
        let qty = inputQty;
        let protein, carbs, fats;

        if (ingredient === 'Egg') {
          protein = +(data.protein * qty).toFixed(2);
          carbs = +(data.carbs * qty).toFixed(2);
          fats = +(data.fats * qty).toFixed(2);
          qty = +(50 * qty).toFixed(0); // assume 1 egg = 50g for display
        } else {
          const factor = qty / 100;
          protein = +(data.protein * factor).toFixed(2);
          carbs = +(data.carbs * factor).toFixed(2);
          fats = +(data.fats * factor).toFixed(2);
        }

        const item = {
          name: ingredient,
          quantity: qty,
          protein,
          carbs,
          fats,
        };

        meals[mealName].push(item);
        renderMeals();
      }

      function renderMeals() {
        mealsContainer.innerHTML = '';

        let totalQty = 0,
          totalProtein = 0,
          totalCarbs = 0,
          totalFats = 0;

        for (let mealName in meals) {
          const mealItems = meals[mealName];
          if (mealItems.length === 0) continue;

          const mealDiv = document.createElement('div');
          mealDiv.className = 'meal-block';

          const heading = document.createElement('h2');
          heading.textContent =
            mealName.charAt(0).toUpperCase() + mealName.slice(1);
          mealDiv.appendChild(heading);

          const table = document.createElement('table');
          table.innerHTML = `
        <thead>
          <tr>
            <th>Ingredient</th>
            <th>Quantity</th>
            <th>Protein (g)</th>
            <th>Carbs (g)</th>
            <th>Fats (g)</th>
          </tr>
        </thead>
        <tbody>
          ${mealItems
            .map((item) => {
              totalQty += item.quantity;
              totalProtein += item.protein;
              totalCarbs += item.carbs;
              totalFats += item.fats;
              return `
              <tr>
                <td>${item.name}</td>
                <td>${item.quantity}${item.name === 'Egg' ? 'g (egg)' : 'g'}</td>
                <td>${item.protein}</td>
                <td>${item.carbs}</td>
                <td>${item.fats}</td>
              </tr>
            `;
            })
            .join('')}
        </tbody>
      `;
          mealDiv.appendChild(table);
          mealsContainer.appendChild(mealDiv);
        }

        document.getElementById('dailyQty').textContent = totalQty + 'g';
        document.getElementById('dailyProtein').textContent =
          totalProtein.toFixed(2) + 'g';
        document.getElementById('dailyCarbs').textContent =
          totalCarbs.toFixed(2) + 'g';
        document.getElementById('dailyFats').textContent =
          totalFats.toFixed(2) + 'g';
      }
    </script>
  </body>
</html>
